javascript:!function(){"use strict";const t=Object.freeze({COMMENT_THRESHOLDS:[20,50,100,200,500],DEFAULT_THRESHOLD:100,SCROLL_INTERVAL_MS:4e3,OVERLAY_ID:"commentOverlayResults",VERSION:"0.6.0",MAX_SCROLLS:200,SCROLL_END_MARGIN:150,SCROLL_DETECTION_DELAY:2500,CLICK_FEEDBACK_DURATION:300,MAX_SCROLL_RETRIES:3,CONTENT_LOAD_TIMEOUT:5e3,SELECTORS:{POSTS:"div.feed-shared-update-v2",COMMENT_BUTTON:['button.social-details-social-counts__btn[aria-label*="Kommentar"]','button.social-details-social-counts__btn[aria-label*="comment"]','button.social-details-social-counts__btn[aria-label*="Comment"]','button.social-details-social-counts__btn[aria-label*="commentaire"]','button.social-details-social-counts__btn[aria-label*="comentario"]','button.social-details-social-counts__btn[aria-label*="commento"]','button.social-details-social-counts__btn[aria-label*="reactie"]','button.social-details-social-counts__btn[aria-label*="coment√°rio"]'].join(", "),COMMENT_SPAN:'span[aria-hidden="true"]',FEED_CONTAINER:"main.scaffold-layout__main",LOAD_MORE_BUTTON:"button.artdeco-button--secondary",LOAD_MORE_TEXTS:["Neue Beitr√§ge anzeigen","Show new posts","Afficher les nouveaux posts","Mostrar nuevas publicaciones","Mostra nuovi post","Nieuwe berichten weergeven","Mostrar novas publica√ß√µes","Ver novas publica√ß√µes"]}});class e{constructor(){this.scrollCount=0,this.scrollInterval=null,this.results=[],this.seenPostIds=new Set,this.postsVisible=!0,this.paused=!1,this.isMinimized=!1,this.overlayPosition=this.getSavedPosition(),this.scrollFailureDetected=!1,this.scrollRetryCount=0,this.lastScrollHeight=0,this.mutationObserver=null,this.contentLoaded=!1,this.commentThreshold=this.getSavedThreshold()}getSavedPosition(){try{return localStorage.getItem("scannerOverlayPosition")||"right"}catch(t){return"right"}}getSavedThreshold(){try{const e=parseInt(localStorage.getItem("scannerCommentThreshold"),10);if(-1!==t.COMMENT_THRESHOLDS.indexOf(e))return e}catch(t){}return t.DEFAULT_THRESHOLD}setThreshold(e){if(-1!==t.COMMENT_THRESHOLDS.indexOf(e)){this.commentThreshold=e;try{localStorage.setItem("scannerCommentThreshold",e)}catch(t){}}}reset(){this.scrollCount=0,this.scrollFailureDetected=!1,this.scrollRetryCount=0,this.paused=!1}addResult(t){return!this.results.some(e=>e.link===t.link)&&(this.results.unshift(t),!0)}}const o={extractNumber(t){const e=t.replace(/\./g,"").replace(/,/g,"").replace(/\s/g,"").match(/\d+/);return e?parseInt(e[0],10):0},debounce(t,e){let o;return function(...s){clearTimeout(o),o=setTimeout(()=>{clearTimeout(o),t(...s)},e)}},createElement(t,e,o){e=e||{},o=o||{};const s=document.createElement(t);for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t]);for(const t in o)if(Object.prototype.hasOwnProperty.call(o,t))try{s.style[t]=o[t]}catch(e){console.warn("Style assignment failed:",t,e)}return s},getScrollInfo(){const e=Math.max(document.documentElement.scrollHeight||0,document.body.scrollHeight||0),o=window.scrollY||window.pageYOffset||0,s=window.innerHeight||document.documentElement.clientHeight||0;return{maxScroll:e,currentScroll:o,nearBottom:o+s>=e-t.SCROLL_END_MARGIN,windowHeight:s}},getParentWithDataId(t){if(!t)return null;try{return t.closest("[data-id]")}catch(e){let o=t.parentElement;for(;o;){if(o.getAttribute&&o.getAttribute("data-id"))return o;o=o.parentElement}return null}}},s={removeExisting(t){const e=document.getElementById(t);e&&e.parentNode&&e.parentNode.removeChild(e)},createButton(t,e,s){const n=o.createElement("button",{textContent:t},{padding:"4px 8px",backgroundColor:e,color:"white",border:"none",cursor:"pointer",fontSize:"13px",borderRadius:"6px",marginRight:"8px"});return n.onclick=s,this.addClickFeedback(n),n},addClickFeedback(e){e.addEventListener("click",function(){const o=e.style.backgroundColor;e.style.backgroundColor="#d3d3d3",setTimeout(function(){e.style.backgroundColor=o},t.CLICK_FEEDBACK_DURATION)})}};const n=new class{constructor(){this.state=new e,this.init()}init(){this.validateEnvironment()&&(this.setupMutationObserver(),this.startScanning())}validateEnvironment(){return-1!==window.location.href.indexOf("linkedin.com/feed")||(alert("Comments Scanner only works on your LinkedIn feed.\nPlease open https://www.linkedin.com/feed/ in this tab and start the Comments Scanner again."),!1)}setupMutationObserver(){const e=this;try{this.state.mutationObserver=new MutationObserver(function(o){for(let s=0;s<o.length;s++){const n=o[s];if(n.addedNodes&&n.addedNodes.length>0)for(let o=0;o<n.addedNodes.length;o++){const s=n.addedNodes[o];if(1===s.nodeType){if(s.matches&&s.matches(t.SELECTORS.POSTS))return void(e.state.contentLoaded=!0);if(s.querySelector&&s.querySelector(t.SELECTORS.POSTS))return void(e.state.contentLoaded=!0)}}}});const o=document.querySelector(t.SELECTORS.FEED_CONTAINER)||document.body;this.state.mutationObserver.observe(o,{childList:!0,subtree:!0})}catch(t){console.warn("MutationObserver not available:",t)}}scanPosts(){const e=document.querySelectorAll(t.SELECTORS.POSTS);let o=0;for(let t=0;t<e.length;t++){const s=e[t],n=this.getPostDataId(s);if(!this.isValidPost(n))continue;this.state.seenPostIds.add(n);const i=this.getCommentCount(s);if(i>=this.state.commentThreshold){const t={link:"https://www.linkedin.com/feed/update/"+n,comments:i,postNode:s};this.state.addResult(t)&&o++}}return this.updateOverlay("Scroll #"+this.state.scrollCount+" ‚Äî Found "+o+" new | Total: "+this.state.results.length),o}getPostDataId(t){let e=t.getAttribute("data-id");if(!e){const s=o.getParentWithDataId(t);e=s?s.getAttribute("data-id"):null}return e}isValidPost(t){return t&&!this.state.seenPostIds.has(t)&&-1!==t.indexOf("activity:")}getCommentCount(e){const s=e.querySelector(t.SELECTORS.COMMENT_BUTTON);if(!s)return 0;const n=s.querySelector(t.SELECTORS.COMMENT_SPAN),i=n?n.innerText.trim():"";return o.extractNumber(i)}clickLoadMoreButton(){const e=document.querySelectorAll(t.SELECTORS.LOAD_MORE_BUTTON);for(let o=0;o<e.length;o++){const s=e[o],n=(s.textContent||s.innerText||"").trim();for(let e=0;e<t.SELECTORS.LOAD_MORE_TEXTS.length;e++)if(-1!==n.indexOf(t.SELECTORS.LOAD_MORE_TEXTS[e])){console.log('üîò Found "Load more" button: "'+n+'" - clicking...');try{return s.click(),this.updateOverlay('Clicked "'+n+'" - loading more posts...'),!0}catch(t){console.warn("Failed to click load-more button:",t)}}}return!1}scrollAndScan(){const e=this;if(this.state.paused||this.state.scrollFailureDetected)return;if(this.clickLoadMoreButton())return void setTimeout(function(){e.scanPosts()},2e3);const s=o.getScrollInfo(),n=s.currentScroll,i=s.maxScroll;if(this.state.scrollCount++,this.state.contentLoaded=!1,this.state.scrollCount>=t.MAX_SCROLLS)this.handleMaxScrollsReached();else{console.log("‚¨áÔ∏è Scrolling to: "+s.maxScroll+" (Scroll #"+this.state.scrollCount+")");try{window.scrollTo({top:s.maxScroll,behavior:"smooth"})}catch(t){window.scrollTo(0,s.maxScroll)}setTimeout(function(){e.validateScroll(n,i)},t.SCROLL_DETECTION_DELAY)}}validateScroll(e,s){const n=this,i=o.getScrollInfo(),l=i.currentScroll,r=i.maxScroll>s+100,a=Math.abs(l-e)>50,c=this.state.contentLoaded;if(console.log("üìä Scroll check: pageGrew="+r+", didScroll="+a+", contentDetected="+c+", retries="+this.state.scrollRetryCount),r||a||c)this.state.scrollRetryCount=0,this.scanPosts();else if(i.nearBottom){if(this.clickLoadMoreButton())return console.log("üîò Found load-more button at bottom - waiting for content..."),this.state.scrollRetryCount=0,void setTimeout(function(){n.scanPosts()},2e3);this.state.scrollRetryCount++,this.state.scrollRetryCount>=t.MAX_SCROLL_RETRIES?(console.warn("‚ö†Ô∏è Reached bottom after "+t.MAX_SCROLL_RETRIES+" retries ‚Äî no more content."),this.handleScrollFailure("end of feed reached (after "+t.MAX_SCROLL_RETRIES+" retries)")):(console.log("üîÑ Retry "+this.state.scrollRetryCount+"/"+t.MAX_SCROLL_RETRIES+" - waiting for content..."),this.updateOverlay("Waiting for content... (retry "+this.state.scrollRetryCount+"/"+t.MAX_SCROLL_RETRIES+")"),setTimeout(function(){n.scrollAndScan()},t.CONTENT_LOAD_TIMEOUT))}else this.state.scrollRetryCount++,this.state.scrollRetryCount>=t.MAX_SCROLL_RETRIES?(console.warn("‚ö†Ô∏è Scroll failed after "+t.MAX_SCROLL_RETRIES+" retries."),this.handleScrollFailure("scroll blocked (after "+t.MAX_SCROLL_RETRIES+" retries)")):(console.log("üîÑ Scroll retry "+this.state.scrollRetryCount+"/"+t.MAX_SCROLL_RETRIES),this.scanPosts())}handleMaxScrollsReached(){this.state.paused=!0,this.stopScrolling(),this.updateOverlay("Auto-paused after "+t.MAX_SCROLLS+" scrolls | Found: "+this.state.results.length),alert("Auto-scrolling paused after "+t.MAX_SCROLLS+" scrolls.\n\nFound "+this.state.results.length+" posts with 100+ comments.\n\nClick 'Resume' to continue.")}handleScrollFailure(t){this.state.paused=!0,this.state.scrollFailureDetected=!0,this.stopScrolling(),this.updateOverlay("‚ö†Ô∏è Paused: "+t+" | Found: "+this.state.results.length),alert("‚ö†Ô∏è Comments Scanner paused: "+t+"\n\nFound "+this.state.results.length+" posts so far.\n\nYou can:\n‚Ä¢ Scroll down manually to load more content\n‚Ä¢ Click 'Resume' to continue scanning\n‚Ä¢ Export results with 'CSV Download'")}startScanning(){const e=this;this.state.scrollInterval||(this.state.lastScrollHeight=o.getScrollInfo().maxScroll,this.scrollAndScan(),this.state.scrollInterval=setInterval(function(){e.scrollAndScan()},t.SCROLL_INTERVAL_MS))}stopScrolling(){this.state.scrollInterval&&(clearInterval(this.state.scrollInterval),this.state.scrollInterval=null)}togglePause(){this.state.paused?(this.state.reset(),this.startScanning()):(this.state.paused=!0,this.stopScrolling()),this.updateOverlay()}toggleMinimize(){this.state.isMinimized=!this.state.isMinimized,this.updateOverlay()}togglePostsVisibility(){this.state.postsVisible=!this.state.postsVisible;const e=document.querySelectorAll("#"+t.OVERLAY_ID+" .post-snippet");for(let t=0;t<e.length;t++)e[t].style.display=this.state.postsVisible?"":"none";this.updateOverlay()}copyToClipboard(){const t=[];for(let e=0;e<this.state.results.length;e++){const o=this.state.results[e],s=o.link.match(/activity:(\d+)/),n=s?s[1]:o.link;t.push("Post ID: "+n+" ‚Äî "+o.link+" ‚Äî "+o.comments+" comments")}const e=t.join("\n");navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then(function(){alert("Copied "+t.length+" results to clipboard!")}).catch(function(t){console.error("Clipboard failed:",t),this.fallbackCopy(e)}.bind(this)):this.fallbackCopy(e)}fallbackCopy(t){const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select();try{document.execCommand("copy"),alert("Copied to clipboard!")}catch(e){alert("Copy failed. Please copy manually from console."),console.log(t)}document.body.removeChild(e)}downloadCSV(){const t=[["Post ID","URL","Comments"]];for(let e=0;e<this.state.results.length;e++){const o=this.state.results[e],s=o.link.match(/activity:(\d+)/),n=s?s[1]:o.link;t.push([n,o.link,o.comments])}const e=[];for(let o=0;o<t.length;o++){const s=t[o],n=[];for(let t=0;t<s.length;t++)n.push('"'+String(s[t]).replace(/"/g,'""')+'"');e.push(n.join(","))}const o=e.join("\n");try{const t=new Blob([o],{type:"text/csv;charset=utf-8;"}),e=URL.createObjectURL(t),s=document.createElement("a");s.href=e,s.download="linkedin_posts_"+(new Date).toISOString().split("T")[0]+".csv",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(e),alert("Downloaded "+this.state.results.length+" results.")}catch(t){console.error("Download failed:",t),alert("Download failed. Check console for data."),console.log(o)}}close(){this.stopScrolling(),this.state.mutationObserver&&(this.state.mutationObserver.disconnect(),this.state.mutationObserver=null),s.removeExisting(t.OVERLAY_ID),this.state.seenPostIds.clear(),this.state.results.length=0}createOverlay(e){e=e||"",s.removeExisting(t.OVERLAY_ID);const o=this.createOverlayContainer(),n=this.createHeader();if(o.appendChild(n),!this.state.isMinimized){const t=this.createStatusSection(e),s=this.createThresholdSection(),n=this.createControlsSection(),i=this.createResultsSection();o.appendChild(t),o.appendChild(s),o.appendChild(n),o.appendChild(i)}document.body.appendChild(o)}createOverlayContainer(){const e={position:"fixed",top:"10px",width:this.state.isMinimized?"270px":"500px",maxHeight:"90vh",overflowY:this.state.isMinimized?"hidden":"auto",zIndex:"99999",backgroundColor:"#fff",border:"1px solid #ccc",borderRadius:"6px",boxShadow:"0 2px 10px rgba(0,0,0,0.2)",padding:this.state.isMinimized?"5px 10px":"10px",fontSize:"14px",fontFamily:"Arial, sans-serif",boxSizing:"border-box",cursor:"default"};return e[this.state.overlayPosition]="10px",this.state.isMinimized&&(e.height="40px"),o.createElement("div",{id:t.OVERLAY_ID},e)}createHeader(){const e=o.createElement("div",{},{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move"}),s=o.createElement("h3",{textContent:"Comments Scanner v"+t.VERSION},{margin:"0",fontSize:"16px"}),n=this.createHeaderControls();return e.appendChild(s),e.appendChild(n),e}createHeaderControls(){const t=this,e=o.createElement("div"),n=s.createButton(this.state.isMinimized?"+":"‚àí","#888",function(){t.toggleMinimize()});n.style.marginRight="6px";const i=s.createButton("‚úï","#6c757d",function(){t.close()});return i.style.marginRight="0",e.appendChild(n),e.appendChild(i),e}createStatusSection(t){return o.createElement("div",{textContent:t||"Found: "+this.state.results.length+" posts with "+this.state.commentThreshold+"+ comments"},{margin:"8px 0",fontStyle:"italic",color:"#666"})}createThresholdSection(){const e=this,s=o.createElement("div",{},{marginBottom:"10px",display:"flex",alignItems:"center",gap:"8px"}),n=o.createElement("span",{textContent:"Min. Comments:"},{fontSize:"13px",color:"#333",marginRight:"4px"});s.appendChild(n);const i=o.createElement("div",{},{display:"flex",gap:"4px"});for(let s=0;s<t.COMMENT_THRESHOLDS.length;s++){const n=t.COMMENT_THRESHOLDS[s],l=n===e.state.commentThreshold,r=o.createElement("button",{textContent:String(n)},{padding:"3px 8px",fontSize:"12px",border:l?"2px solid #0073b1":"1px solid #ccc",borderRadius:"4px",backgroundColor:l?"#0073b1":"#f5f5f5",color:l?"#fff":"#333",cursor:"pointer",fontWeight:l?"bold":"normal",minWidth:"36px",transition:"all 0.2s"});r.onmouseover=function(){n!==e.state.commentThreshold&&(r.style.backgroundColor="#e0e0e0")},r.onmouseout=function(){n!==e.state.commentThreshold&&(r.style.backgroundColor="#f5f5f5")},r.onclick=function(){e.setThreshold(n)},i.appendChild(r)}return s.appendChild(i),s}setThreshold(t){this.state.setThreshold(t),console.log("üìä Comment threshold changed to: "+t),this.updateOverlay("Threshold set to "+t+"+ comments")}createControlsSection(){const t=this,e=o.createElement("div",{},{marginBottom:"12px"}),n=[{text:this.state.paused?"Resume":"Pause",color:"#f0ad4e",action:function(){t.togglePause()}},{text:"Clipboard",color:"#5bc0de",action:function(){t.copyToClipboard()}},{text:"CSV Download",color:"#5cb85c",action:function(){t.downloadCSV()}},{text:this.state.postsVisible?"Hide posts":"Show posts",color:"#888",action:function(){t.togglePostsVisibility()}}];for(let t=0;t<n.length;t++){var i=n[t];e.appendChild(s.createButton(i.text,i.color,i.action))}return e}createResultsSection(){const t=o.createElement("div",{id:"results-list"});for(let e=0;e<this.state.results.length;e++){const s=this.state.results[e],n=s.link.match(/activity:(\d+)/),i=n?n[1]:s.link,l=o.createElement("div",{},{marginBottom:"8px"}),r=o.createElement("a",{href:s.link,target:"_blank",textContent:"‚ûú Open Post ID: "+i+" ‚Äî "+s.comments+" comments"},{display:"inline-block",padding:"6px 12px",backgroundColor:"#0073b1",color:"#fff",textDecoration:"none",borderRadius:"4px",fontSize:"13px",fontWeight:"bold",cursor:"pointer",border:"none",transition:"background-color 0.2s"});if(r.onmouseover=function(){r.style.backgroundColor="#005582"},r.onmouseout=function(){r.style.backgroundColor="#0073b1"},l.appendChild(r),t.appendChild(l),s.postNode){const e=this.createPostSnippet(s.postNode);t.appendChild(e)}}return t}createPostSnippet(t){const e=t.cloneNode(!0);return e.className=(e.className||"")+" post-snippet",e.style.maxWidth="100%",e.style.border="1px solid #ddd",e.style.marginBottom="15px",e.style.padding="5px",e.style.backgroundColor="#fafafa",e.style.borderRadius="6px",e.style.display=this.state.postsVisible?"":"none",e}updateOverlay(t){this.createOverlay(t)}};window.linkedInScanner=n}();
